# Секреты и переменные GitHub Actions

Для корректной работы CI/CD pipeline необходимо настроить следующие секреты и переменные в настройках репозитория:

## Необходимые секреты (Sensitive Values)

### Сервер развертывания
Для развертывания на сервере необходимы SSH ключи и учетные данные:

- `SSH_HOST` - хост сервера
- `SSH_USER` - пользователь для подключения к серверу
- `SSH_PRIVATE_KEY` - приватный SSH ключ для подключения к серверу

### Приложение
Для работы приложения требуются следующие секреты:

- `JWT_SECRET` - секретный ключ для JWT аутентификации
- `DB_PASSWORD` - пароль для базы данных

## Необходимые переменные (Non-Sensitive Values)

### Backend Variables
- `BACKEND_PORT` - порт для бэкенд-сервера (по умолчанию: 8080)
- `BACKEND_UPLOAD_PATH` - путь для загрузки файлов (по умолчанию: ./app/uploads)
- `BACKEND_MAX_FILE_SIZE` - максимальный размер файла в байтах (по умолчанию: 52428800 для 50MB)
- `BACKEND_MAX_ATTEMPTS_HANDLED` - количество попыток обработки (по умолчанию: 3)
- `BACKEND_HANDLER_TIMEOUT` - таймаут в часах (по умолчанию: 24)
- `DB_HOST` - хост базы данных (по умолчанию: db)
- `DB_PORT` - порт базы данных (по умолчанию: 5432)
- `DB_USER` - пользователь базы данных (по умолчанию: postgres)
- `DB_NAME` - имя базы данных (по умолчанию: obscura)
- `ML_SERVICE_URL` - URL для ML-сервиса (по умолчанию: http://ml-service:8000)
- `ML_SERVICE_ENABLED` - включен ли ML-сервис (по умолчанию: true)

### ML Service Variables
- `ML_WORKERS` - количество ML-воркеров (по умолчанию: 3)

### Frontend Variables
- `NEXT_PUBLIC_API_LINK` - ссылка на API для фронтенда (по умолчанию: http://localhost:8080)

## Настройка секретов и переменных

1. Перейдите в настройки репозитория на GitHub
2. Выберите раздел "Secrets and variables" -> "Actions"
3. Для секретов: Нажмите кнопку "New repository secret", введите имя секрета и его значение
4. Для переменных: Нажмите кнопку "New repository variable", введите имя переменной и ее значение
5. Повторите для всех необходимых секретов и переменных

## CI/CD Интеграция

Секреты и переменные используются в файле `.github/workflows/ci.yml` для генерации .env файлов в соответствующих директориях:
- `/backend/backend-app/.env` - для бэкенд-приложения
- `/backend/ml/.env` - для ML-сервиса
- `/frontend/.env` - для фронтенд-приложения

## Безопасность

- Никогда не храните секреты в коде репозитория
- Используйте сильные пароли и токены
- Регулярно обновляйте секреты
- Разделяйте чувствительные данные (секреты) и нечувствительные (переменные)